<!doctype html>
{% load static %}
{% load i18n %}
<html lang="en">
<head>
	<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Dissertatsiyalarni mavzu yoki muallif bo ªyicha qidirish uchun veb-sahifa">
    <meta name="keywords" content="dissertatsiya, qidiruv, mavzu, muallif, ilmiy ish">
    <title>Dissertatsiyalarni qidirish</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
	<!-- Codezeel added -->
	<link href="//fonts.googleapis.com/css?family=Inter:100,200,300,400,500,600,700,800,900" rel="stylesheet">
	<link href="//fonts.googleapis.com/css?family=Libre+Baskerville:400,700" rel="stylesheet">
	<link rel="stylesheet" href="{% static "css/theme.css" %}" type="text/css" media="all">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
	      integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
	      crossorigin="anonymous" referrerpolicy="no-referrer"/>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        /* Header stillari */
        #header {
          background-color: #f8f9fa; /* Orqali rang */
          padding: 20px 0; /* Yuqori va pastki padding */
          border-bottom: 1px solid #dee2e6; /* Pastki chegara */
        }
        
        .header_logo {
          text-align: center; /* Logoni markazlash */
        }
        
        .header_logo img {
          max-width: 200px; /* Logo enini cheklash */
        }
        
        /* Qidiruv maydoni stillari */
        #search_widget {
          margin-top: 20px; /* Yuqori margin */
        }
        
        #search_widget input[type="text"] {
          width: 100%; /* Input enini to'liq qilish */
          padding: 10px; /* Padding */
          border: 1px solid #ced4da; /* Chegara */
          border-radius: 5px; /* Burchaklarni yumaloqlash */
        }
        
        /* User info stillari */
        .user-info {
          margin-top: 20px; /* Yuqori margin */
          text-align: right; /* O'ngga tekislash */
        }
        
        /* Tilni tanlash stillari */
        .language-selector {
          margin-top: 20px; /* Yuqori margin */
          text-align: right; /* O'ngga tekislash */
        }
        
        /* Menyu stillari */
        .menu ul {
          list-style: none; /* Belgini olib tashlash */
          padding: 0; /* Paddingni olib tashlash */
          margin: 0; /* Marginni olib tashlash */
          text-align: center; /* Markazlash */
        }
        
        .menu li {
          display: inline-block; /* Elementlarni yonma-yon joylashtirish */
          margin: 0 10px; /* Elementlar orasidagi margin */
        }
        
        .menu a {
          text-decoration: none; /* Chiziqni olib tashlash */
          color: #343a40; /* Havola rangi */
        }
        
        /* Main stillari */
        #page {
          padding-top: 30px; /* Yuqori padding */
        }
        
        /* Footer stillari */
        #footer {
          background-color: #343a40; /* Orqali rang */
          color: #fff; /* Matn rangi */
          padding: 30px 0; /* Yuqori va pastki padding */
        }
        
        #footer .block {
          margin-bottom: 20px; /* Bloklar orasidagi margin */
        }
        
        #footer h3 {
          color: #fff; /* Sarlavha rangi */
        }
        
        #footer ul {
          list-style: none; /* Belgini olib tashlash */
          padding: 0; /* Paddingni olib tashlash */
        }
        
        #footer li {
          margin-bottom: 10px; /* Elementlar orasidagi margin */
        }
        
        #footer a {
          color: #fff; /* Havola rangi */
          text-decoration: none; /* Chiziqni olib tashlash */
        }
    </style>
</head>
<body id="category"
      class="lang-en country-de currency-eur layout-left-column page-category tax-display-enabled category-id-9 category-cooking category-id-parent-2 category-depth-level-2">
<header id="header">
    <div class="header-banner">
    </div>
    <div class="header-top">
        <div class="header_logo">
            <a href="{% url "main" %}">
                <img class="logo img-responsive" src="{% static "img/smarttuit1.png" %}" alt="smarttuit logo">
            </a>
        </div>

        <div id="search_widget" class="col-lg-4 col-md-5 col-sm-12 search-widget" data-search-controller-url="{% url 'search' %}">
            <span class="search_button"></span>
            <div class="search_toggle">
                <form method="get" action="{% url 'search' %}">
                    <input type="hidden" name="controller" value="search">
                    <input type="text" name="q" value="{{ request.GET.q|default_if_none:'' }}" placeholder="Search our catalog">
                    <button type="submit"></button>
                    <button type="button" class="voice-search-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
                            <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z"/>
                        </svg>
                    </button>
                </form>
            </div>
        </div>

        <style>
            /* Qidiruv vidjeti uchun maxsus CSS */
            #search_widget {
                position: relative;
                width: 100%;
                max-width: 400px;
                margin: auto;
            }

            #search_widget .search_toggle {
                display: flex;
                align-items: center;
                background: #f8f9fa;
                border-radius: 8px;
                padding: 5px;
                border: 1px solid #ddd;
            }

            #search_widget input[type="text"] {
                flex: 1;
                border: none;
                outline: none;
                padding: 8px;
                font-size: 16px;
            }

            #search_widget button {
                background: #ff0000;
                border: none;
                color: white;
                padding: 8px 12px;
                border-radius: 4px;
                cursor: pointer;
            }

            #search_widget button:hover {
                background: #b30000;
            }
            #search_widget {
                position: relative;
                width: 100%;
                max-width: 400px;
                margin: auto;
            }

            #search_widget .search_toggle {
                display: flex;
                align-items: center;
                background: #f8f9fa;
                border-radius: 8px;
                padding: 5px;
                border: 1px solid #ddd;
            }

            #search-input {
                flex: 1;
                border: none;
                outline: none;
                padding: 8px;
                font-size: 16px;
            }

            #search-form button[type="submit"] {
                background: #ff0026;
                border: none;
                color: white;
                padding: 8px 12px;
                border-radius: 4px;
                cursor: pointer;
            }

            #search-form button[type="submit"]:hover {
                background: #b30000;
            }

            .voice-search-btn {
                border: none;
                background-color: transparent;
                cursor: pointer;
                padding: 0;
                margin-left: 5px;
            }
        </style>

        <div class="user-info dropdown js-dropdown">
              <span class="user-info-title expand-more _gray-darker" data-toggle="dropdown"><span class="account_text">{% if user.is_authenticated %}{{ user.first_name }} {{ user.last_name }}{% else %}My Account{% endif %}</span></span>
              <ul class="dropdown-menu">
                 <li>
                     {% if user.is_authenticated %}
                        <!-- User is authenticated, show logout link or any other authenticated content -->
                         <li>
                            <a href="{% url "profile" %}" title="Profile">Profile</a>
                         </li>
                        <li>
                            <a href="{% url 'logout' %}" title="Logout">Logout</a>
                        </li>

                     {% else %}
                        <!-- User is not authenticated, show login and register links -->
                        <li>
                            <a class="dropdown-item" href="{% url 'login' %}" title="Log in to your customer account" rel="nofollow">
                                <span>Sign in</span>
                            </a>
                        </li>
                        <li>
                            <a href="{% url 'register' %}" data-link-action="display-register-form">Register</a>
                        </li>
                    {% endif %}
              </ul>
        </div>
        <div class="language-selector" id="language-selector">
            <div class="language_block">
                {% get_current_language as CURRENT_LANGUAGE %}
                {% get_available_languages as AVAILABLE_LANGUAGES %}
                {% get_language_info_list for AVAILABLE_LANGUAGES as languages %}
                <span class="language-title">Language:</span>
                <ul>
                    {% for language in languages %}
                        <li  {% if language.code == CURRENT_LANGUAGE %} class="current"{% endif %}>
                            <a href="/{{ language.code }}/" class="language-item">{{ language.name_local }}</a>
                        </li><br>
                    {% endfor %}
                </ul>
            </div>
        </div>

        <div class="header-top-inner">
            <div class="text-xs-left mobile hidden-lg-up mobile-menu">
                <div class="menu-icon">
                    <div class="cat-title">Menu</div>
                </div>
                <div id="mobile_top_menu_wrapper" class="row hidden-lg-up">
                    <div class="mobile-menu-inner">
                        <div class="menu-icon">
                            <div class="cat-title">Menu</div>
                        </div>
                        <div class="js-top-menu mobile" id="_mobile_top_menu"></div>
                    </div>
                </div>
            </div>
            <div class="menu col-lg-12 js-top-menu position-static hidden-md-down" id="_desktop_top_menu">
                <ul class="top-menu  container" id="top-menu" data-depth="0">
                    <li class="category" id="category-search">
                        <a class="dropdown-item" href="{% url 'searching_dissertations' %}" data-depth="0">
                            Dissertatsiyalar bazasi
                        </a>
                    </li>
                    {% for category in categories %}
                        <li class="category" id="category-6">
                            <a class="dropdown-item" href="{% url "category" category.id %}" data-depth="0">
                                {{ category.name }}
                            </a>
                        </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
</header>

<main id="page">    <!-- Header -->
    
    <!-- Qidiruv bo'limi -->
    <div class="container mt-5">
        <div class="card shadow-lg p-4">
            <h2 class="text-center mb-4">Dissertatsiyalar bazasi</h2>
            <form id="search-form" class="row g-3">
                {% csrf_token %}  <!-- Django CSRF Token -->
                <div class="col-md-6">
                    <input type="text" id="title" class="form-control" placeholder="Mavzu bo‚Äòyicha qidirish" autocomplete="off">
                </div>
                <div class="col-md-6">
                    <input type="text" id="author" class="form-control" placeholder="Muallif bo‚Äòyicha qidirish" autocomplete="off">
                </div>
                <div class="col-12 text-center">
                    <button type="submit" class="btn btn-primary w-50">Qidirish</button>
                </div>
            </form>
            <div id="error-message" class="alert alert-danger mt-3 d-none"></div>
            <div id="search-results" class="mt-4 table-responsive"></div>
            
            <!-- Sahifalash -->
            <nav>
                <ul class="pagination justify-content-center mt-3">
                    <li class="page-item disabled" id="prev-page">
                        <a class="page-link" href="#" aria-label="Oldingi">‚¨Ö Oldingi</a>
                    </li>
                    <li class="page-item active" id="page-info">
                        <span class="page-link">1 / 1</span>
                    </li>
                    <li class="page-item disabled" id="next-page">
                        <a class="page-link" href="#" aria-label="Keyingi">Keyingi ‚û°</a>
                    </li>
                </ul>
            </nav>
            
            <style>
                nav ul.pagination {
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    margin-top: 1rem;
                }
            
                nav ul.pagination li.page-item {
                    margin: 0 5px;
                }
            
                nav ul.pagination li.page-item a.page-link,
                nav ul.pagination li.page-item span.page-link {
                    min-width: 90px; /* –¢—É–≥–º–∞–ª–∞—Ä–Ω–∏–Ω–≥ –º–∏–Ω–∏–º–∞–ª –∫–µ–Ω–≥–ª–∏–≥–∏–Ω–∏ –±–µ–ª–≥–∏–ª–∞—à */
                    padding: 0.5rem 1rem;
                    border: 1px solid #dee2e6;
                    border-radius: 0.25rem;
                    color: #b30000;
                    text-decoration: none;
                    cursor: pointer;
                    display: flex; /* –≠–ª–µ–º–µ–Ω—Ç–ª–∞—Ä–Ω–∏ —Ñ–ª–µ–∫—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–≥–∞ –∞–π–ª–∞–Ω—Ç–∏—Ä–∏—à */
                    align-items: center; /* –≠–ª–µ–º–µ–Ω—Ç–ª–∞—Ä–Ω–∏ –≤–µ—Ä—Ç–∏–∫–∞–ª –º–∞—Ä–∫–∞–∑–ª–∞—à */
                    justify-content: center; /* –≠–ª–µ–º–µ–Ω—Ç–ª–∞—Ä–Ω–∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª –º–∞—Ä–∫–∞–∑–ª–∞—à */
                    overflow: hidden; /* –Å–∑—É–≤–Ω–∏–Ω–≥ —Ç—É–≥–º–∞–¥–∞–Ω —á–∏“õ–∏–± –∫–µ—Ç–∏—à–∏–Ω–∏ –æ–ª–¥–∏–Ω–∏ –æ–ª–∏—à */
                    word-break: normal; /* –Å–∑—É–≤–Ω–∏–Ω–≥ –±—û–ª–∏–Ω–∏—à–∏–Ω–∏ –æ–ª–¥–∏–Ω–∏ –æ–ª–∏—à */
                    white-space: nowrap; /* –Å–∑—É–≤–Ω–∏–Ω–≥ –±–∏—Ä “õ–∞—Ç–æ—Ä–¥–∞ “õ–æ–ª–∏—à–∏–Ω–∏ —Ç–∞—ä–º–∏–Ω–ª–∞—à */
                }
            
                nav ul.pagination li.page-item a.page-link:hover {
                    background-color: #e9ecef;
                }
            
                nav ul.pagination li.page-item.active span.page-link {
                    background-color: #b30000;
                    color: #fff;
                    border-color: #b30000;
                    cursor: default;
                }
            
                nav ul.pagination li.page-item.disabled a.page-link,
                nav ul.pagination li.page-item.disabled span.page-link {
                    color: #6c757d;
                    background-color: #fff;
                    border-color: #dee2e6;
                    cursor: default;
                }
            </style>
        </div>
    </div>

    <!-- Footer -->
    
</main>
<footer id="footer">
		<div class="footer-before">
			<div class="container">
			</div>
		</div>
		<div class="footer-container">
			<div class="container">
				<div class="row footer">
					<div id="czfootercmsblock" class="footer-cms-block col-md-4 links block">
						<div id="footerlogo">
							<div class="footerdiv">
								<div class="footerlogo"></div>
								<div
										class="footerdesc">{% trans "Oliy ta'lim muassasalarining yagona elektron kutubxona axborot tizimi" %}</div>
							</div>
						</div>
					</div>
					<div class="col-md-4 links block">
						<h3 class="h3 hidden-md-down">{% trans "Bo'limlar" %}</h3>
						<div class="title h3 block_title hidden-lg-up" data-target="#footer_sub_menu_91655"
						     data-toggle="collapse">
							<span class="">{% trans "Bo'limlar" %}</span>
							<span class="pull-xs-right">
                          <span class="navbar-toggler collapse-icons">
                          <i class="fa-icon add"></i>
                          <i class="fa-icon remove"></i>
                          </span>
                          </span>
						</div>
						<ul id="footer_sub_menu_91655" class="collapse block_content">

							<li>
								<a
										id="link-product-page-new-products-1"
										class="cms-page-link"
										href="#"
										title="Our new products">
									{% trans 'Yangiliklar' %}
								</a>
							</li>
							<li>
								<a
										id="link-product-page-best-sales-1"
										class="cms-page-link"
										href="#"
										title="Our best sales">
									{% trans "Bizning Jamoa" %}
								</a>
							</li>
							<li>
								<a
										id="link-static-page-contact-1"
										class="cms-page-link"
										href="#"
										title="Use our form to contact us">
									{% trans "Biz bilan bog'lanish" %}
								</a>
							</li>
							<li>
								<a
										id="link-static-page-sitemap-1"
										class="cms-page-link"
										href="#">
									{% trans "Biz haqimizda" %}
								</a>
							</li>
						</ul>
					</div>
					<div class="col-md-4 links block">
						<h3 class="h3 hidden-md-down">{% trans 'Resurslar' %}</h3>
						<div class="title h3 block_title hidden-lg-up" data-target="#footer_sub_menu_23580"
						     data-toggle="collapse">
							<span class="">{% trans 'Resurslar' %}</span>
							<span class="pull-xs-right">
                          <span class="navbar-toggler collapse-icons">
                          <i class="fa-icon add"></i>
                          <i class="fa-icon remove"></i>
                          </span>
                          </span>
						</div>
						<ul id="footer_sub_menu_23580" class="collapse block_content">
							<li>
								<a
										id="link-cms-page-1-2"
										class="cms-page-link"
										href="#"
										title="Our terms and conditions of delivery">
									{% trans 'Adabiyotlar' %}
								</a>
							</li>
							<li>
								<a
										id="link-cms-page-2-2"
										class="cms-page-link"
										href="#"
										title="Legal notice">
									{% trans 'Maqolalar' %}
								</a>
							</li>
							<li>
								<a
										id="link-cms-page-3-2"
										class="cms-page-link"
										href="#"
										title="Our terms and conditions of use">
									{% trans 'Dissertatsiyalar' %}
								</a>
							</li>
							<li>
								<a
										id="link-cms-page-4-2"
										class="cms-page-link"
										href="#"
										title="Learn more about us">
									{% trans 'Monografiyalar' %}
								</a>
							</li>

						</ul>
					</div>
					<div class="block-contact col-md-4 links wrapper">
						<h3 class="text-uppercase block-contact-title hidden-sm-down"><a href="#">Bog'lanish</a>
						</h3>
						<div class="title clearfix hidden-md-up" data-target="#block-contact_list"
						     data-toggle="collapse">
							<span class="h3">{% trans "Bog'lanish" %}</span>
							<span class="pull-xs-right">
                          <span class="navbar-toggler collapse-icons">
                          <i class="fa-icon add"></i>
                          <i class="fa-icon remove"></i>
                          </span>
                          </span>
						</div>
						<ul id="block-contact_list" class="collapse">
							<li>
								<i class="fa fa-map-marker"></i>
								<span>{% trans "Manzil: Toshkent 100084, Amir Temur shox ko‚Äòchasi 108 uy" %}</span>
							</li>
							<li>
								<i class="fa fa-phone"></i>
								<span>+998 90 716 10 67</span>
							</li>
							<li>
								<i class="fa fa-envelope-o"></i>
								<span>smartuit@gmail.com</span>
							</li>
						</ul>
					</div>
					<style>
                        #cookie_notice {
                            background: #222222;
                            padding: 12px;
                            text-align: center;
                            color: #fff;
                            z-index: 99;
                            position: fixed;
                            width: 100%;
                            bottom: 0px;
                            right: 0;
                            left: 0;
                        }

                        #cookie_notice a {
                            text-decoration: underline;
                            color: #fff;
                        }

                        #cookie_notice a:hover {
                            text-decoration: none;
                        }

                        .closeButtonNormal {
                            text-align: center;
                            padding: 2px 5px;
                            border-radius: 2px;
                            cursor: pointer;
                        }

                        #cookieNotice p {
                            margin: 0px;
                            padding: 0px;
                        }

                        .cookie-button {
                            padding: 4px 13px;
                            margin-left: 10px;
                            font-size: 13px;
                            background: #fff;
                            color: #000;
                            border-radius: 3px;
                        }

                        #footer {
                            margin-bottom: 56px;
                        }

                        .top_button {
                            bottom: 100px;
                        }
					</style>
				</div>
			</div>
		</div>
		</div>
		<div class="footer-after">
			<div class="container">
				<div class="copyright">
					<a class="_blank" href="">
						¬© 2024 - {% trans "O‚Äòzbekiston Respublikasi Oliy ta'lim, fan va innovatsiyalar vazirligi" %}
					</a>
				</div>
			</div>
		</div>
		<a class="top_button" href="#" style="">&nbsp;</a>
</footer>
    <script>
        // CSRF token-ni olish funksiyasi
        function getCookie(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }

        // CSRF token-ni olish
        const csrftoken = getCookie('csrftoken');

        // Formani yuborish
        document.getElementById("search-form").addEventListener("submit", function (event) {
            event.preventDefault();

            let title = sanitizeInput(document.getElementById("title").value.trim());
            let author = sanitizeInput(document.getElementById("author").value.trim());
            let resultsDiv = document.getElementById("search-results");
            let errorDiv = document.getElementById("error-message");

            resultsDiv.innerHTML = "";
            errorDiv.classList.add("d-none");

            if (!title && !author ) {
                errorDiv.textContent = "‚ùå Iltimos, kamida bitta maydonni to‚Äòldiring!";
                errorDiv.classList.remove("d-none");
                return;
            }

            resultsDiv.innerHTML = `<div class="text-center mt-3"><div class="spinner-grow text-primary" role="status"></div><p>Yuklanmoqda...</p></div>`;

            // Axios so ªrovini yuborish
            axios.post("/ru/searching/", {  
                title: title,
                author: author
            }, {
                headers: { 
                    "Content-Type": "application/json",
                    "X-CSRFToken": csrftoken  // CSRF token-ni yuborish
                }
            })
            .then(response => {
                resultsDiv.innerHTML = "";

                if (!response.data.results || response.data.results.length === 0) {
                    resultsDiv.innerHTML = `<div class="alert alert-warning text-center">‚ùå Siz kiritgan so‚Äòrov bo‚Äòyicha hech qanday dissertatsiya topilmadi. Iltimos, boshqa kalit so‚Äòzlar bilan qayta urinib ko‚Äòring.</div>`;
                    return;
                }

                renderResults(response.data.results);
            })
            .catch(error => {
                if (error.response && error.response.data) {
                    errorDiv.textContent = `‚ùå Xatolik: ${error.response.data.message}`;
                } else {
                    errorDiv.textContent = "‚ùå Xatolik yuz berdi!";
                }
                errorDiv.classList.remove("d-none");
                resultsDiv.innerHTML = "";
            });
        });

        let currentPage = 1;
        const itemsPerPage = 10;
        let searchResults = [];

        // Natijalarni ko ªrsatish
        function renderResults(results) {
            searchResults = results;
            currentPage = 1;
            updatePagination();
            showPage(currentPage);
        }

        // Sahifani ko ªrsatish
        function showPage(page) {
            let resultsDiv = document.getElementById("search-results");
            let start = (page - 1) * itemsPerPage;
            let end = start + itemsPerPage;
            let pageItems = searchResults.slice(start, end);

            let tableHTML = `
                <table class="table table-bordered table-striped">
                    <thead class="table-dark">
                        <tr>
                            <th><a href="#" class="sortable" data-sort="title">Mavzu</a></th>
                            <th><a href="#" class="sortable" data-sort="author">Muallif</a></th>
                            <th>Kod</th>
                            <th><a href="#" class="sortable" data-sort="year">Yil</a></th>
                            <th>Tur</th>
                            <th>Razdel</th>
                            <th>Sahifalar</th>
                            <th>O‚Äòqilgan</th>
                            <th>Yuklangan</th>
                            <th>Batafsil</th>
                        </tr>
                    </thead>
                    <tbody>`;

            pageItems.forEach(item => {
                let bookUrl = item.uuid ? `/ru/book/${item.uuid}/` : "#";
                tableHTML += `
                    <tr>
                        <td>${item.Title}</td>
                        <td>${item.Author}</td>
                        <td>${item.Code}</td>
                        <td>${item.Year || "Noma'lum"}</td>
                        <td>${item.turi}</td>
                        <td>${item.razdel}</td>
                        <td>${item.sahifalar}</td>
                        <td>${item.reads}</td>
                        <td>${item.downloads !== null ? item.downloads : "0"}</td>
                        <td><a href="${bookUrl}" class="btn btn-info btn-sm">üìñ Batafsil</a></td>
                    </tr>`;
            });

            tableHTML += "</tbody></table>";
            resultsDiv.innerHTML = tableHTML;

            // Sortable ustunlar uchun event listener qo'shish
            document.querySelectorAll('.sortable').forEach(header => {
                header.addEventListener('click', function(event) {
                    event.preventDefault();
                    sortTable(this.dataset.sort);
                });
            });
        }

        // Jadvalni saralash
        function sortTable(sortBy) {
            searchResults.sort((a, b) => {
                if (a[sortBy] < b[sortBy]) return -1;
                if (a[sortBy] > b[sortBy]) return 1;
                return 0;
            });
            showPage(currentPage);
        }

        // Pagination-ni yangilash
        function updatePagination() {
            let totalPages = Math.ceil(searchResults.length / itemsPerPage);
            document.getElementById("page-info").innerHTML = `<span class="page-link">${currentPage} / ${totalPages}</span>`;
        
            // –ö–ª–∞—Å—Å–ª–∞—Ä–Ω–∏ “õ—û—à–∏—à –≤–∞ –æ–ª–∏–± —Ç–∞—à–ª–∞—à –ª–æ–≥–∏–∫–∞—Å–∏–Ω–∏ —Ç–µ–∫—à–∏—Ä–∏–Ω–≥
            if (currentPage === 1) {
                document.getElementById("prev-page").classList.add("disabled");
            } else {
                document.getElementById("prev-page").classList.remove("disabled");
            }
        
            if (currentPage === totalPages) {
                document.getElementById("next-page").classList.add("disabled");
            } else {
                document.getElementById("next-page").classList.remove("disabled");
            }
        }

        // Oldingi sahifaga o ªtish
        document.getElementById("prev-page").addEventListener("click", function () {
            if (currentPage > 1) {
                currentPage--;
                showPage(currentPage);
                updatePagination();
            }
        });

        // Keyingi sahifaga o ªtish
        document.getElementById("next-page").addEventListener("click", function () {
            let totalPages = Math.ceil(searchResults.length / itemsPerPage);
            if (currentPage < totalPages) {
                currentPage++;
                showPage(currentPage);
                updatePagination();
            }
        });

        // Inputni tozalash (XSS himoyasi)
        function sanitizeInput(input) {
                    return input.replace(/</g, "&lt;").replace(/>/g, "&gt;");
                }
                const voiceSearchButton = document.querySelector('.voice-search-btn');
        const searchInput = document.querySelector('#search_widget input[type="text"]'); // Qidiruv maydonini tanlash
        
       
        document.addEventListener("DOMContentLoaded", function () {
            const voiceSearchButton = document.querySelector('.voice-search-btn');
            const searchInput = document.getElementById('title'); // Qidiruv maydoni to‚Äòg‚Äòri tanlanganligini tekshiring
            const searchForm = document.getElementById("search-form");
        
            if ('webkitSpeechRecognition' in window) {
                const recognition = new webkitSpeechRecognition();
                recognition.continuous = false;
                recognition.lang = 'uz-UZ';
        
                voiceSearchButton.addEventListener('click', () => {
                    recognition.start();
                });
        
                recognition.onresult = (event) => {
                    const transcript = event.results[0][0].transcript.trim();
                    searchInput.value = transcript; // Matnni input maydoniga joylash
                    
                    console.log("Ovoz bilan qidirilgan matn:", transcript); // Konsolda tekshirish
        
                    // Formani avtomatik yuborish
                    searchForm.dispatchEvent(new Event("submit"));
                };
        
                recognition.onerror = (event) => {
                    console.error("Ovozli qidiruv xatosi:", event.error);
                };
            } else {
                console.warn("Brauzeringiz ovozli qidiruvni qo‚Äòllab-quvvatlamaydi.");
            }
        });

    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script type="text/javascript" src="{% static "js/core.js" %}"></script>
    <script type="text/javascript" src="{% static "js/theme.js" %}"></script>
    <script type="text/javascript" src="{% static "js/front.js" %}"></script>
    <script type="text/javascript" src="{% static "js/myprestacomments.js" %}"></script>
    <script type="text/javascript" src="{% static "js/stfeature_compare.js" %}"></script>
    <script type="text/javascript" src="{% static "js/stfeature_wishlist.js" %}"></script>
    <script type="text/javascript" src="{% static "js/czcouponpop.js" %}"></script>
    <script type="text/javascript" src="{% static "js/front.js" %}"></script>
    <script type="text/javascript" src="{% static "js/ps_shoppingcart.js" %}"></script>
    <script type="text/javascript" src="{% static "js/parallax.js" %}"></script>
    <script type="text/javascript" src="{% static "js/owl.carousel.js" %}"></script>
    <script type="text/javascript" src="{% static "js/totalstorage.js" %}"></script>
    <script type="text/javascript" src="{% static "js/lightbox.js" %}"></script>
    <script type="text/javascript" src="{% static "js/lazysizes.min.js" %}"></script>
    <script type="text/javascript" src="{% static "js/custom.js" %}"></script>
    <script src="{% static "js/index.js" %}"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script type="text/javascript" src="{% static "js/jquery.rating.pack.js" %}"></script>
    <script type="text/javascript" src="{% static "js/jquery.textareaCounter.plugin.js" %}"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script type="text/javascript" src="{% static "js/jquery-ui.min.js" %}"></script>
    <script type="text/javascript" src="{% static "js/jquery.fancybox.js" %}"></script>
    <script type="text/javascript" src="{% static "js/jquery.nivo.slider.js" %}"></script>
    <script type="text/javascript" src="{% static "js/core.js" %}"></script>
    <script type="text/javascript" src="{% static "js/theme.js" %}"></script>
    <script type="text/javascript" src="{% static "js/front.js" %}"></script>
    <script type="text/javascript" src="{% static "js/jquery.rating.pack.js" %}"></script>
    <script type="text/javascript" src="{% static "js/jquery.textareaCounter.plugin.js" %}"></script>
    <script type="text/javascript" src="{% static "js/myprestacomments.js" %}"></script>
    <script type="text/javascript" src="{% static "js/stfeature_compare.js" %}"></script>
    <script type="text/javascript" src="{% static "js/stfeature_wishlist.js" %}"></script>
    <script type="text/javascript" src="{% static "js/czcouponpop.js" %}"></script>
    <script type="text/javascript" src="{% static "js/front.js" %}"></script>
    <script type="text/javascript" src="{% static "js/jquery-ui.min.js" %}"></script>
    <script type="text/javascript" src="{% static "js/jquery.fancybox.js" %}"></script>
    <script type="text/javascript" src="{% static "js/ps_shoppingcart.js" %}"></script>
    <script type="text/javascript" src="{% static "js/jquery.nivo.slider.js" %}"></script>
    <script type="text/javascript" src="{% static "js/parallax.js" %}"></script>
    <script type="text/javascript" src="{% static "js/owl.carousel.js" %}"></script>
    <script type="text/javascript" src="{% static "js/totalstorage.js" %}"></script>
    <script type="text/javascript" src="{% static "js/lightbox.js" %}"></script>
    <script type="text/javascript" src="{% static "js/lazysizes.min.js" %}"></script>
    <script type="text/javascript" src="{% static "js/custom.js" %}"></script>
</body>
</html>